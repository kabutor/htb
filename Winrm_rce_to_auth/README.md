I just copy the Nishang Powershell-TCP-Reverse and adapt it.
To use this you need to supply credentials (edit the file) and via Winrm it will auth and return a shell with the authenticated user.

